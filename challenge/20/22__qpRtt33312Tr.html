<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="./challengestyle20.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Jockey+One&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="" />
    <title>DÃ©fi</title>
    <script src="https://kit.fontawesome.com/80cd6fff3b.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="vertical-center">
            <h4 class="center"></h4>
            <br>
            <div class="img-row center" style="margin-left: 50px;">
                <div id="label"
                    style="vertical-align: top; background-image: url(22/3r.png); display:inline-block; width:100px; height:38.216px; background-size:contain; margin:5px;">
                </div>
                <div id="label"
                    style="vertical-align: top; background-image: url(22/1r.png); display:inline-block; width:100px; height:38.216px; background-size:contain; margin:5px;">
                </div>
                <div id="label"
                    style="vertical-align: top; background-image: url(22/2r.png); display:inline-block; width:100px; height:38.216px; background-size:contain; margin:5px;">
                </div>
                <div id="label"
                    style="vertical-align: top; background-image: url(22/3r.png); display:inline-block; width:100px; height:38.216px; background-size:contain; margin:5px;">
                </div>
            </div>
            <div class="img-row center">
                <div id="label"
                    style="vertical-align: top; background-image: url(22/3c.png); display:inline-block; width:38.216px; height:98px; background-size:contain; margin:5px;">
                </div>
                <div id="1" onclick="imgClicked('1')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="2" onclick="imgClicked('2')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="3" onclick="imgClicked('3')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="4" onclick="imgClicked('4')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(90deg);">
                </div>
            </div>
            <div class="img-row center">
                <div id="label"
                    style="vertical-align: top; background-image: url(22/2c.png); display:inline-block; width:38.216px; height:98px; background-size:contain; margin:5px;">
                </div>
                <div id="5" onclick="imgClicked('5')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(90deg);">
                </div>
                <div id="6" onclick="imgClicked('6')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(90deg);">
                </div>
                <div id="7" onclick="imgClicked('7')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="8" onclick="imgClicked('8')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;transform: rotate(180deg);">
                </div>
            </div>
            <div class="img-row center">
                <div id="label"
                    style="vertical-align: top; background-image: url(22/3c.png); display:inline-block; width:38.216px; height:98px; background-size:contain; margin:5px;">
                </div>
                <div id="9" onclick="imgClicked('9')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="10" onclick="imgClicked('10')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(180deg);">
                </div>
                <div id="11" onclick="imgClicked('11')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(270deg);">
                </div>
                <div id="12" onclick="imgClicked('12')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(180deg);">
                </div>
            </div>
            <div class="img-row center">
                <div class="label"
                    style="vertical-align: top; background-image: url(22/1c.png); display:inline-block; width:38.216px; height:98px; background-size:contain; margin:5px;">
                </div>
                <div id="13" onclick="imgClicked('13')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px;">
                </div>
                <div id="14" onclick="imgClicked('14')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(270deg);">
                </div>
                <div id="15" onclick="imgClicked('15')"
                    style="vertical-align: top; background-image: url(22/dot.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(270deg);">
                </div>
                <div id="16" onclick="imgClicked('16')"
                    style="vertical-align: top; background-image: url(22/square.png); display:inline-block; width:100px; height:100px; background-size:contain; margin:5px; transform: rotate(180deg);">
                </div>
            </div>
            <div class="center">
                <table style="width: 100%; margin: 10px 0;">
                    <tr>
                        <td><h3 class="left" style="margin-left: 25px;" id="tCounter"></h3></td>
                        <td><h3 class="right" style="margin-right: 25px;" id="cStarsCounter"></h3></td>
                    </tr>
                </table>
                
            </div>
            
        </div>
        
    </div>
    </div>

    <script>
        var sets = new Array(16).fill(false);
        var tokens = 9;
        var cStars = 4;

        var rows = [];
        rows.push(new address(3));
        rows.push(new address(2));
        rows.push(new address(3));
        rows.push(new address(1));

        var cols = [];
        cols.push(new address(3));
        cols.push(new address(1));
        cols.push(new address(2));
        cols.push(new address(3));

        document.getElementById("tCounter").innerHTML = tokens;
        document.getElementById("cStarsCounter").innerHTML = cStars;

        async function imgClicked(index) {
            square = document.getElementById(index);

            if (!sets[index]) {
                if (tokens > 0)
                {
                    if (square.style.backgroundImage == "url(\"22/dot.png\")")
                        cStars--;
                    square.style.backgroundImage = "url(22/selected.png)";
                    sets[index] = true;
                    tokens--;

                }
            } else {
                sets[index] = false;
                tokens++;
                switch (index) {
                    case '1':
                    case '4':
                    case '9':
                    case '10':
                    case '14':
                    case '15':
                        square.style.backgroundImage = "url(22/dot.png)";
                        cStars++;
                        break;
                    default:
                        square.style.backgroundImage = "url(22/square.png)";
                        break;
                }
            }

            if (cStars == 0) document.getElementById("cStarsCounter").style.color = "lime"; else document.getElementById("cStarsCounter").style.color = "white";
            if (tokens == 0) document.getElementById("tCounter").style.color = "lime"; else document.getElementById("tCounter").style.color = "white";

            document.getElementById("tCounter").innerHTML = tokens;
            document.getElementById("cStarsCounter").innerHTML = cStars;

            if (cStars == 0 && tokens == 0)
            {   
                for (var i=0; i<13; i+=4)
                {
                    var tokenAmount = 0;
                    for (var j=1; j<5; j++)
                    {
                        if (document.getElementById(i+j).style.backgroundImage == "url(\"22/selected.png\")")
                        {
                            tokenAmount++;
                        }

                        if (tokenAmount == rows[(i/4)].tokenCount)
                        {
                            rows[(i/4)].conditionSet = true;
                        }
                        else {
                            rows[(i/4)].conditionSet = false;
                        }
                        //alert("i = " + i + " j = " + j + " i/4+j = " + (i+j));
                    }
                    tokenAmount = 0;
                }

                for (var i=1; i<5; i++)
                {
                    for (var j=0; j<13; j+=4)
                    {
                        if (document.getElementById(i+j).style.backgroundImage == "url(\"22/selected.png\")")
                        {
                            tokenAmount++;
                        }

                        if (tokenAmount == cols[i-1].tokenCount)
                        {
                            cols[i-1].conditionSet = true;
                        }
                        else {
                            cols[i-1].conditionSet = false;
                        }
                        //alert("i = " + i + " j = " + j + " i/4+j = " + (i+j));
                    }
                    tokenAmount = 0;
                }
                
                var checker = true;
                for (var i=0; i<4; i++)
                {
                    if (!(cols[i].tokenCount && rows[i].tokenCount))
                        checker = false;
                }
                if (checker)
                {
                    await new Promise(r => setTimeout(r, 500));
                    window.location.replace("../20/23__lla3efTTTe32.html");
                }
            }
        }

        function address(tokenCount) {
            this.tokenCount = tokenCount;
            this.conditionSet = false;
        }
    </script>
</body>

</html>